---
title: Pulizia dei dati con criteri di conservazione | Microsoft Docs
description: È possibile specificare la frequenza con cui si desidera eliminare determinati tipi di dati.
author: bholtorf
ms.service: dynamics365-business-central
ms.topic: article
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.search.keywords: delete, data, retention, policy, policies
ms.date: 10/01/2020
ms.author: bholtorf
ms.openlocfilehash: 279a76751b6652221d83ee453cc171bf357c0328
ms.sourcegitcommit: ddbb5cede750df1baba4b3eab8fbed6744b5b9d6
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 10/01/2020
ms.locfileid: "3927688"
---
# <a name="define-retention-policies"></a><span data-ttu-id="59ebb-103">Definire i criteri di conservazione</span><span class="sxs-lookup"><span data-stu-id="59ebb-103">Define Retention Policies</span></span>
<span data-ttu-id="59ebb-104">Gli amministratori possono definire i criteri di conservazione per specificare la frequenza con cui desiderano che [!INCLUDE[prodshort](includes/prodshort.md)] elimini i dati obsoleti nelle tabelle che contengono voci di log e record archiviati.</span><span class="sxs-lookup"><span data-stu-id="59ebb-104">Administrators can define retention policies to specify how frequently they want [!INCLUDE[prodshort](includes/prodshort.md)] to delete outdated data in tables that contain log entries and archived records.</span></span> <span data-ttu-id="59ebb-105">Ad esempio, la pulizia delle voci di log può semplificare il lavoro con i dati effettivamente rilevanti.</span><span class="sxs-lookup"><span data-stu-id="59ebb-105">For example, cleaning up log entries can make it easier to work with the data that's actually relevant.</span></span> <span data-ttu-id="59ebb-106">I criteri possono includere tutti i dati nelle tabelle che hanno superato la data di scadenza oppure è possibile aggiungere criteri di filtro che includeranno solo determinati dati scaduti nel criterio.</span><span class="sxs-lookup"><span data-stu-id="59ebb-106">Policies can include all data in the tables that is past the expiration date, or you can add filter criteria that will include only certain expired data in the policy.</span></span> 

## <a name="required-setups-and-permissions"></a><span data-ttu-id="59ebb-107">Configurazioni obbligatorie e autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="59ebb-107">Required Setups and Permissions</span></span>
<span data-ttu-id="59ebb-108">Prima di poter creare i criteri di conservazione, è necessario impostare quanto segue.</span><span class="sxs-lookup"><span data-stu-id="59ebb-108">Before you can create retention policies, you must set up the following.</span></span>

|<span data-ttu-id="59ebb-109">Installazione</span><span class="sxs-lookup"><span data-stu-id="59ebb-109">Setup</span></span>  |<span data-ttu-id="59ebb-110">Descrizione</span><span class="sxs-lookup"><span data-stu-id="59ebb-110">Description</span></span>  |
|---------|---------|
|<span data-ttu-id="59ebb-111">**Tabelle consentite**</span><span class="sxs-lookup"><span data-stu-id="59ebb-111">**Allowed Tables**</span></span>     |<span data-ttu-id="59ebb-112">Viene fornito un elenco delle tabelle che possono essere incluse nei criteri di conservazione.</span><span class="sxs-lookup"><span data-stu-id="59ebb-112">We provide a list of the tables that can be included in retention policies.</span></span> <span data-ttu-id="59ebb-113">Tuttavia, se si desidera aggiungere tabelle da un'estensione a un criterio di conservazione, uno sviluppatore deve aggiungere le proprie tabelle all'elenco.</span><span class="sxs-lookup"><span data-stu-id="59ebb-113">However, if you want to add tables from an extension to a retention policy a developer must add their tables to the list.</span></span> <span data-ttu-id="59ebb-114">Per ulteriori informazioni, vedere [Includere l'estensione in un criterio di conservazione](admin-data-retention-policies.md#including-your-extension-in-a-retention-policy-requires-help-from-a-developer).</span><span class="sxs-lookup"><span data-stu-id="59ebb-114">For more information, see [Including Your Extension in a Retention Policy](admin-data-retention-policies.md#including-your-extension-in-a-retention-policy-requires-help-from-a-developer).</span></span>          |
|<span data-ttu-id="59ebb-115">**Periodi di conservazione**</span><span class="sxs-lookup"><span data-stu-id="59ebb-115">**Retention Periods**</span></span>     |<span data-ttu-id="59ebb-116">Specificare i periodi di tempo per conservare i dati nelle tabelle in un criterio.</span><span class="sxs-lookup"><span data-stu-id="59ebb-116">Specify periods of time for which to keep data in the tables in a policy.</span></span> <span data-ttu-id="59ebb-117">I periodi determinano la frequenza con cui i dati verranno eliminati.</span><span class="sxs-lookup"><span data-stu-id="59ebb-117">The periods determine how often data will be deleted.</span></span>         |

<span data-ttu-id="59ebb-118">Inoltre, è necessario disporre delle autorizzazioni utente con privilegi avanzati o del set di autorizzazioni Setup criteri di conservazione.</span><span class="sxs-lookup"><span data-stu-id="59ebb-118">Additionally, you must have the SUPER user permissions or the Retention Policy Setup permission set.</span></span> <span data-ttu-id="59ebb-119">Gli utenti a cui viene concesso il set di autorizzazioni Setup criteri di conservazione possono definire criteri di conservazione per le tabelle, anche se non dispongono delle autorizzazioni di lettura ed eliminazione per tali tabelle.</span><span class="sxs-lookup"><span data-stu-id="59ebb-119">Users who are granted the Retention Policy Setup permission set can define retention policies for tables, even if they do not have Read and Delete permissions for those tables.</span></span> <span data-ttu-id="59ebb-120">Il movimento coda processi deve essere eseguito come utente con autorizzazioni per leggere ed eliminare i dati.</span><span class="sxs-lookup"><span data-stu-id="59ebb-120">The job queue entry must run as a user with permissions to read and delete the data.</span></span> <span data-ttu-id="59ebb-121">Si consiglia di non concedere il set di autorizzazioni Setup criteri di conservazione agli utenti a cui non è consentito eliminare i dati.</span><span class="sxs-lookup"><span data-stu-id="59ebb-121">We recommend that you do not grant the Retention Policy Setup permission set to users who should not be allowed to delete data.</span></span>

> [!NOTE]
> <span data-ttu-id="59ebb-122">Se si utilizza [!INCLUDE[prodshort](includes/prodshort.md)] in locale e si desidera provare i criteri di conservazione nel database dimostrativo di Cronus, è necessario eseguire alcune operazioni.</span><span class="sxs-lookup"><span data-stu-id="59ebb-122">If you are using [!INCLUDE[prodshort](includes/prodshort.md)] on-premises, and you want to try out retention policies in the the Cronus demonstration database, there are a few things you need to do.</span></span> <span data-ttu-id="59ebb-123">La società di dimostrazione non contiene tabelle che è possibile utilizzare con i criteri di conservazione, quindi è necessario aggiungerle.</span><span class="sxs-lookup"><span data-stu-id="59ebb-123">The demonstration company does not contain tables that you can use with retention policies, so you need to add them.</span></span> <span data-ttu-id="59ebb-124">A tale scopo, creare una nuova società vuota nel database dimostrativo.</span><span class="sxs-lookup"><span data-stu-id="59ebb-124">To do that, create a new, blank company in the demonstration database.</span></span> <span data-ttu-id="59ebb-125">Nella nuova società, importare il pacchetto di configurazione RapidStart per il proprio paese che corrisponde al pacchetto NAV17.0.W1.ENU.STANDARD.rapidstart standard.</span><span class="sxs-lookup"><span data-stu-id="59ebb-125">In the new company, import the RapidStart configuration package for your country that corresponds to the standard NAV17.0.W1.ENU.STANDARD.rapidstart package.</span></span> <span data-ttu-id="59ebb-126">I dati di setup per i criteri di conservazione saranno disponibili nella nuova società.</span><span class="sxs-lookup"><span data-stu-id="59ebb-126">The setup data for retention policies will be available in the new company.</span></span>

### <a name="to-create-retention-periods"></a><span data-ttu-id="59ebb-127">Per creare periodi di conservazione</span><span class="sxs-lookup"><span data-stu-id="59ebb-127">To create retention periods</span></span>
<span data-ttu-id="59ebb-128">I periodi di conservazione possono essere lunghi o brevi come si desidera.</span><span class="sxs-lookup"><span data-stu-id="59ebb-128">Retention periods can be as long or as short as you want.</span></span> <span data-ttu-id="59ebb-129">Per creare periodi di conservazione, nella pagina **Criteri di conservazione** usare l'azione **Periodo di conservazione**.</span><span class="sxs-lookup"><span data-stu-id="59ebb-129">To create retention periods, on the **Retention Policies** page, use the **Retention Period** action.</span></span> <span data-ttu-id="59ebb-130">I periodi definiti saranno disponibili per tutte i criteri.</span><span class="sxs-lookup"><span data-stu-id="59ebb-130">The periods you define will be available for all policies.</span></span>

> [!NOTE]
> <span data-ttu-id="59ebb-131">Per motivi di conformità, è stato definito un periodo di conservazione minimo per alcune tabelle.</span><span class="sxs-lookup"><span data-stu-id="59ebb-131">For compliance reasons, we have defined a minimum retention period for some tables.</span></span> <span data-ttu-id="59ebb-132">Se si imposta un periodo di conservazione inferiore al minimo richiesto, un messaggio visualizzerà il periodo obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="59ebb-132">If you set a retention period that is shorter than minimum required, a message will display the mandatory period.</span></span>

### <a name="set-up-a-retention-policy"></a><span data-ttu-id="59ebb-133">Impostare i criteri di conservazione</span><span class="sxs-lookup"><span data-stu-id="59ebb-133">Set up a retention policy</span></span>
1. <span data-ttu-id="59ebb-134">Scegliere l'icona a forma di ![lampadina che consente di aprire la funzionalità delle informazioni](media/ui-search/search_small.png "Informazioni sull'operazione che si desidera eseguire"), immettere **Criteri di conservazione** e quindi scegliere il collegamento correlato.</span><span class="sxs-lookup"><span data-stu-id="59ebb-134">Choose the ![Lightbulb that opens the Tell Me feature](media/ui-search/search_small.png "Tell me what you want to do") icon, enter **Retention Policies**, and choose the related link.</span></span>
2. <span data-ttu-id="59ebb-135">Nel campo **ID tabella**, scegliere la tabella che si desidera includere nel criterio.</span><span class="sxs-lookup"><span data-stu-id="59ebb-135">In the **Table ID** field, choose the table that you want to include in the policy.</span></span>
3. <span data-ttu-id="59ebb-136">Nel campo **Periodo di conservazione** specificare il periodo di tempo per il quale conservare i dati nella tabella.</span><span class="sxs-lookup"><span data-stu-id="59ebb-136">In the **Retention Period** field, specify the length of time for which to keep the data in the table.</span></span>
4. <span data-ttu-id="59ebb-137">Facoltativo: per applicare il criterio a dati specifici in una tabella, disattivare il pulsante Applica a tutti i record.</span><span class="sxs-lookup"><span data-stu-id="59ebb-137">Optional: To apply the policy to specific data in a table, turn off the Apply to all records toggle.</span></span> <span data-ttu-id="59ebb-138">Verrà visualizzata la Scheda dettaglio Criteri di conservazione dei record, in cui è possibile impostare i filtri per creare sottoinsiemi di dati per ciascuna riga.</span><span class="sxs-lookup"><span data-stu-id="59ebb-138">The Record Retention Policy FastTab will display, where you can set filters to create subsets of data for each line.</span></span> <span data-ttu-id="59ebb-139">Per ulteriori informazioni, vedere [Filtri](ui-enter-criteria-filters.md#filtering).</span><span class="sxs-lookup"><span data-stu-id="59ebb-139">For more information, see [Filtering](ui-enter-criteria-filters.md#filtering).</span></span>

   > [!NOTE]
   > <span data-ttu-id="59ebb-140">Ogni riga ha il proprio periodo di conservazione.</span><span class="sxs-lookup"><span data-stu-id="59ebb-140">Each line has its own retention period.</span></span> <span data-ttu-id="59ebb-141">Se si specificano periodi di conservazione diversi per gli stessi dati, verrà utilizzato il periodo più lungo.</span><span class="sxs-lookup"><span data-stu-id="59ebb-141">If you specify different retention periods for the same data, the longest period will be used.</span></span> <span data-ttu-id="59ebb-142">Inoltre, alcune tabelle contengono filtri che non è possibile modificare o rimuovere.</span><span class="sxs-lookup"><span data-stu-id="59ebb-142">Also, some tables contain filters that you cannot change or remove.</span></span> <span data-ttu-id="59ebb-143">Per identificare con chiarezza questi filtri, vengono visualizzati con un carattere di colore più chiaro.</span><span class="sxs-lookup"><span data-stu-id="59ebb-143">To help you identify these filters, they appear in a lighter color font.</span></span>

## <a name="applying-retention-policies"></a><span data-ttu-id="59ebb-144">Applicazione dei criteri di conservazione</span><span class="sxs-lookup"><span data-stu-id="59ebb-144">Applying Retention Policies</span></span>
<span data-ttu-id="59ebb-145">È possibile utilizzare un movimento coda processi per applicare i criteri di conservazione per eliminare automaticamente i dati oppure applicare manualmente i criteri.</span><span class="sxs-lookup"><span data-stu-id="59ebb-145">You can use a job queue entry to apply retention policies to delete data automatically, or you can manually apply policies.</span></span>

<span data-ttu-id="59ebb-146">Per applicare automaticamente un criterio di conservazione, è sufficiente creare e abilitare un criterio.</span><span class="sxs-lookup"><span data-stu-id="59ebb-146">To apply a retention policy automatically, just create and enable a policy.</span></span> <span data-ttu-id="59ebb-147">Quando si abilita un criterio, viene creato un movimento coda processi che applicherà i criteri di conservazione in base al periodo di conservazione specificato.</span><span class="sxs-lookup"><span data-stu-id="59ebb-147">When you enable a policy we create a job queue entry that will apply retention policies according to the retention period you specify.</span></span> <span data-ttu-id="59ebb-148">Tutti i criteri di conservazione utilizzeranno lo stesso movimento coda processi.</span><span class="sxs-lookup"><span data-stu-id="59ebb-148">All retention policies will use the same job queue entry.</span></span> <span data-ttu-id="59ebb-149">Per impostazione predefinita, il movimento coda processi applica il criterio ogni giorno alle 02.00.</span><span class="sxs-lookup"><span data-stu-id="59ebb-149">By default, the job queue entry applies the policy every day at 0200.</span></span> <span data-ttu-id="59ebb-150">È possibile modificare l'impostazione predefinita, ma in tal caso è consigliabile eseguirla al di fuori dell'orario di lavoro.</span><span class="sxs-lookup"><span data-stu-id="59ebb-150">You can change the default, but if you do we recommend that it runs outside business hours.</span></span> <span data-ttu-id="59ebb-151">Per ulteriori informazioni, vedere [Utilizzare le code processi per pianificare i task](admin-job-queues-schedule-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="59ebb-151">For more information, see [Use Job Queues to Schedule Tasks](admin-job-queues-schedule-tasks.md).</span></span> 

<span data-ttu-id="59ebb-152">È possibile applicare manualmente un criterio utilizzando l'azione **Applica manualmente** nella pagina **Criteri di conservazione**.</span><span class="sxs-lookup"><span data-stu-id="59ebb-152">You can manually apply a policy by using the **Apply Manually** action on the **Retention Policies** page.</span></span> <span data-ttu-id="59ebb-153">Per applicare sempre un criterio manualmente, attivare l'interruttore **Manuale**.</span><span class="sxs-lookup"><span data-stu-id="59ebb-153">If you want to always apply a policy manually, turn on the **Manual** toggle.</span></span> <span data-ttu-id="59ebb-154">Il movimento coda processi ignorerà il criterio quando viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="59ebb-154">The job queue entry will disregard the policy when it runs.</span></span>

## <a name="viewing-retention-policy-log-entries"></a><span data-ttu-id="59ebb-155">Visualizzazione delle voci di log dei criteri di conservazione</span><span class="sxs-lookup"><span data-stu-id="59ebb-155">Viewing Retention Policy Log Entries</span></span>
<span data-ttu-id="59ebb-156">È possibile visualizzare l'attività relativa ai criteri di conservazione nella pagina **Log criteri di conservazione**.</span><span class="sxs-lookup"><span data-stu-id="59ebb-156">You can view activity related to retention policies in the **Retention Policy Log** page.</span></span> <span data-ttu-id="59ebb-157">Ad esempio, le voci vengono create quando viene applicato un criterio o se si sono verificati errori all'applicazione del criterio.</span><span class="sxs-lookup"><span data-stu-id="59ebb-157">For example, entries are created when when a policy is applied, or if errors occurred when that happened.</span></span> 

## <a name="including-your-extension-in-a-retention-policy-requires-help-from-a-developer"></a><span data-ttu-id="59ebb-158">Includere l'estensione in un criterio di conservazione (richiede l'aiuto di uno sviluppatore)</span><span class="sxs-lookup"><span data-stu-id="59ebb-158">Including Your Extension in a Retention Policy (Requires Help from a Developer)</span></span>
<span data-ttu-id="59ebb-159">Per impostazione predefinita, i criteri di conservazione coprono solo le tabelle incluse nell'elenco di tabelle di [!INCLUDE[prodshort](includes/prodshort.md)] fornito.</span><span class="sxs-lookup"><span data-stu-id="59ebb-159">By default, retention policies cover only tables that are included in the list of [!INCLUDE[prodshort](includes/prodshort.md)] tables that we provide.</span></span> <span data-ttu-id="59ebb-160">È possibile rimuovere le tabelle predefinite dall'elenco e aggiungere le tabelle di proprietà dell'utente.</span><span class="sxs-lookup"><span data-stu-id="59ebb-160">You can remove default tables from the list, and you can add tables that you own.</span></span> <span data-ttu-id="59ebb-161">Cioè, non è possibile aggiungere una tabella che è stata creata personalmente.</span><span class="sxs-lookup"><span data-stu-id="59ebb-161">That is, you cannot add a table that you did not create yourself.</span></span> <span data-ttu-id="59ebb-162">Ad esempio, non è possibile aggiungere altre tabelle da [!INCLUDE[prodshort](includes/prodshort.md)] o da un'estensione acquistata.</span><span class="sxs-lookup"><span data-stu-id="59ebb-162">For example, you cannot add other tables from [!INCLUDE[prodshort](includes/prodshort.md)] or from an extension that you have purchased.</span></span>

<span data-ttu-id="59ebb-163">Per aggiungere le tabelle all'elenco delle tabelle consentite, uno sviluppatore deve aggiungere del codice, ad esempio alla codeunit del programma di installazione per l'estensione (una codeunit con il sottotipo *installa*).</span><span class="sxs-lookup"><span data-stu-id="59ebb-163">To add your tables to the list of allowed tables, a developer must add some code, for example to the installer codeunit for the extension (a codeunit with the *install* subtype).</span></span> 

<span data-ttu-id="59ebb-164">Quando uno sviluppatore aggiunge una tabella, può specificare filtri obbligatori e predefiniti.</span><span class="sxs-lookup"><span data-stu-id="59ebb-164">When a developer adds a table, they can specify mandatory and default filters.</span></span> <span data-ttu-id="59ebb-165">I filtri obbligatori non possono essere rimossi o modificati successivamente quando si aggiungono tabelle per definire un criterio di conservazione.</span><span class="sxs-lookup"><span data-stu-id="59ebb-165">Mandatory filters cannot be removed or modified later when you add tables to define a retention policy.</span></span> <span data-ttu-id="59ebb-166">I filtri predefiniti sono solo suggerimenti.</span><span class="sxs-lookup"><span data-stu-id="59ebb-166">Default filters are just friendly suggestions.</span></span>

<span data-ttu-id="59ebb-167">Di seguito sono riportati esempi di come aggiungere una tabella all'elenco di tabelle consentite con e senza filtri obbligatori o predefiniti.</span><span class="sxs-lookup"><span data-stu-id="59ebb-167">The following are examples of how to add a table to the list of allowed tables with, and without, mandatory or default filters.</span></span> <span data-ttu-id="59ebb-168">Per un esempio più complesso, vedere codeunit 3999 "Reten.</span><span class="sxs-lookup"><span data-stu-id="59ebb-168">For a more complex example, see codeunit 3999 "Reten.</span></span> <span data-ttu-id="59ebb-169">Pol.</span><span class="sxs-lookup"><span data-stu-id="59ebb-169">Pol.</span></span> <span data-ttu-id="59ebb-170">Install - BaseApp".</span><span class="sxs-lookup"><span data-stu-id="59ebb-170">Install - BaseApp".</span></span> 

```
 trigger OnInstallAppPerCompany()
    var
        RetenPolAllowedTables: Codeunit "Reten. Pol. Allowed Tables";
    begin
        RetenPolAllowedTables.AddAllowedTable(Database::"Retention Policy Log Entry");
    end;
```

<span data-ttu-id="59ebb-171">L'esempio seguente include un filtro obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="59ebb-171">The following example includes a mandatory filter.</span></span>

```
 trigger OnInstallAppPerCompany()
    var
        ChangeLogEntry: Record "Change Log Entry";
        RetenPolAllowedTables: Codeunit "Reten. Pol. Allowed Tables";
        RetentionPeriod: Enum "Retention Period Enum";
        RecRef: RecordRef;
        TableFilters: JsonArray;
        Enabled: Boolean;
        Mandatory: Boolean;
    begin
        ChangeLogEntry.Reset();
        ChangeLogEntry.SetFilter("Field Log Entry Feature", '%1|%2', ChangeLogEntry."Field Log Entry Feature"::"Monitor Sensitive Fields", ChangeLogEntry."Field Log Entry Feature"::All);
        RecRef.GetTable(ChangeLogEntry);
        Enabled := true;
        Mandatory := true;
        RetenPolAllowedTables.AddTableFilterToJsonArray(TableFilters, RetentionPeriod::"28 Days", ChangeLogEntry.FieldNo(SystemCreatedAt), Enabled, Mandatory, RecRef);
        RetenPolAllowedTables.AddAllowedTable(Database::"Change Log Entry", ChangeLogEntry.FieldNo(SystemCreatedAt), TableFilters);
    end;
```
<span data-ttu-id="59ebb-172">Dopo che uno sviluppatore ha aggiunto le tabelle all'elenco, un amministratore può includerle in un criterio di conservazione.</span><span class="sxs-lookup"><span data-stu-id="59ebb-172">After a developer has added tables to the list, an administrator can include them in a retention policy.</span></span> 

## <a name="see-also"></a><span data-ttu-id="59ebb-173">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="59ebb-173">See Also</span></span>
[<span data-ttu-id="59ebb-174">Revisione delle modifiche in Business Central</span><span class="sxs-lookup"><span data-stu-id="59ebb-174">Auditing Changes in Business Central</span></span>](across-log-changes.md)  
[<span data-ttu-id="59ebb-175">Filtri</span><span class="sxs-lookup"><span data-stu-id="59ebb-175">Filtering</span></span>](ui-enter-criteria-filters.md#filtering)  
[<span data-ttu-id="59ebb-176">Utilizzare le code processi per pianificare le attività</span><span class="sxs-lookup"><span data-stu-id="59ebb-176">Use Job Queues to Schedule Tasks</span></span>](admin-job-queues-schedule-tasks.md)  
<span data-ttu-id="59ebb-177">[Utilizzo di [!INCLUDE[d365fin](includes/d365fin_md.md)]](ui-work-product.md)</span><span class="sxs-lookup"><span data-stu-id="59ebb-177">[Working with [!INCLUDE[d365fin](includes/d365fin_md.md)]](ui-work-product.md)</span></span>  